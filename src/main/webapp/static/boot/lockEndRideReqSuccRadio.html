<!DOCTYPE html>
<html>
    
    <head>
    	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
        <title>4代锁管理后台</title>
        <!-- Bootstrap -->
        <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
        <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
        <link href="assets/styles.css" rel="stylesheet" media="screen">
        <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="vendors/flot/excanvas.min.js"></script><![endif]-->
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <script src="vendors/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    </head>
    
    <body>
        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#">4代锁管理后台</a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right">
                            <li class="dropdown">
                                <a href="#" role="button" class="dropdown-toggle" data-toggle="dropdown"> <i class="icon-user"></i> 管理员 <i class="caret"></i>

                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a tabindex="-1" href="login.html">Logout</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <!--/.nav-collapse -->
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span2" id="sidebar">
                    <ul class="nav nav-list bs-docs-sidenav nav-collapse collapse">
                        <li >
                            <a href="lockLocationSummarize.html"><i class="icon-chevron-right"></i> GPS定位情况汇总</a>
                        </li>
                        <li>
                            <a href="lbsLocationSummarize.html"><i class="icon-chevron-right"></i> 基站定位情况汇总</a>
                        </li>
                        <li>
                            <a href="#"><i class="icon-chevron-right"></i> APP定位情况汇总</a>
                        </li>
                        <li>
                            <a href="allLocationDetail.html"><i class="icon-chevron-right"></i> 定位情况对比</a>
                        </li>
                        <li>
                            <a href="lockLocationDetail.html"><i class="icon-chevron-right"></i> GPS定位情况明细</a>
                        </li>
                        <li>
                            <a href="lockTestResult.html"><i class="icon-chevron-right"></i> 锁测结果</a>
                        </li>
                        <li>
                            <a href="lockEndRide.html"><i class="icon-chevron-right"></i> 结束计费明细</a>
                        </li>
                        
                        <li class="active">
                            <a href="lockEndRideReqSuccRadio.html"><i class="icon-chevron-right"></i> 结束计费发送请求成功率统计</a>
                        </li>
                        
                        
                        
                    </ul>
                </div>
                <!--/span-->
                <div class="span10" id="content">
                      <!-- morris stacked chart -->

                     <div class="row-fluid">
                        <!-- block -->
                        <div class="block">
                            <div class="navbar navbar-inner block-header">
                                <div class="muted pull-left"> 结束计费发送请求成功率统计</div>
                            </div>
                            <div class="block-content collapse in">
                                <div class="span12">
                                    <form class="form-horizontal">
                                      <fieldset>
                                        <legend></legend>
                                        <div class="control-group">
                                          <label class="control-label" for="date01">开始时间</label>
                                          <div class="controls">
                                            <input type="text" class="input-xlarge datepicker" id="date01" value="">
                                            <p class="help-block"></p>
                                          </div>
                                        </div>
                                        
                                        <div class="control-group">
                                          <label class="control-label" for="date02">结束时间</label>
                                          <div class="controls">
                                            <input type="text" class="input-xlarge datepicker" id="date02" value="">
                                            <p class="help-block"></p>
                                          </div>
                                        </div>
                                        
                                        <div class="control-group">
                                          <label class="control-label" for="textarea2">mac地址</label>
                                          <div class="controls">
                                            <textarea class="input-xlarge textarea macs" placeholder="多个mac地址请换行" style="width: 400px; height: 200px"></textarea>
                                          </div>
                                        </div>
                                        <div class="form-actions">
                                          <button type="button" class="btn btn-primary go-query">查询</button>
                                        </div>
                                      </fieldset>
                                    </form>

                                </div>
                            </div>
                        </div>
                        <!-- /block -->
                    </div>

                     <!-- wizard -->
                    <div class="row-fluid section">
                         <!-- block -->
                        
                        <!-- /block -->
                    </div>
	            <!-- /wizard -->

                     <!-- validation -->
                    
                     <!-- /validation -->
                     
			<div class="row-fluid">
                        <!-- block -->
                        <div class="block">
                            <div class="navbar navbar-inner block-header">
                                <div class="muted pull-left"></div>
                            </div>
                            <div class="block-content collapse in">
                                <div class="span12">
  									<table class="mytable table table-hover">
						              <thead>
						                <tr>
						                  	<th>序号</th>
											<th>MAC地址</th>
											<th>开锁成功次数</th>
											<th>开锁失败次数</th>
											<th>开锁请求次数</th>
											<th>开锁成功率</th>
						                </tr>
						              </thead>
						              <tbody>
						              </tbody>
						            </table>
                                </div>
                            </div>
                        </div>
                        <!-- /block -->
                    </div>                     


                </div>
            </div>
            <hr>
            <footer>

            </footer>
        </div>
        <!--/.fluid-container-->
        <link href="vendors/datepicker.css" rel="stylesheet" media="screen">
        <link href="vendors/uniform.default.css" rel="stylesheet" media="screen">
        <link href="vendors/chosen.min.css" rel="stylesheet" media="screen">

        <link href="vendors/wysiwyg/bootstrap-wysihtml5.css" rel="stylesheet" media="screen">

        <script src="vendors/jquery-1.9.1.js"></script>
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <script src="vendors/jquery.uniform.min.js"></script>
        <script src="vendors/chosen.jquery.min.js"></script>
        <script src="vendors/bootstrap-datepicker.js"></script>

        <script src="vendors/wysiwyg/wysihtml5-0.3.0.js"></script>
        <script src="vendors/wysiwyg/bootstrap-wysihtml5.js"></script>

        <script src="vendors/wizard/jquery.bootstrap.wizard.min.js"></script>

	<script type="text/javascript" src="vendors/jquery-validation/dist/jquery.validate.min.js"></script>
	<script src="assets/form-validation.js"></script>
        
	<script src="assets/scripts.js"></script>
        <script>

	jQuery(document).ready(function() {   
	   FormValidation.init();
	});
	

        $(function() {
            $(".datepicker").datepicker();
            
            $(".uniform_on").uniform();
            $(".chzn-select").chosen();

            $('#rootwizard').bootstrapWizard({onTabShow: function(tab, navigation, index) {
                var $total = navigation.find('li').length;
                var $current = index+1;
                var $percent = ($current/$total) * 100;
                $('#rootwizard').find('.bar').css({width:$percent+'%'});
                // If it's the last tab then hide the last button and show the finish instead
                if($current >= $total) {
                    $('#rootwizard').find('.pager .next').hide();
                    $('#rootwizard').find('.pager .finish').show();
                    $('#rootwizard').find('.pager .finish').removeClass('disabled');
                } else {
                    $('#rootwizard').find('.pager .next').show();
                    $('#rootwizard').find('.pager .finish').hide();
                }
            }});
            $('#rootwizard .finish').click(function() {
                alert('Finished!, Starting over!');
                $('#rootwizard').find("a[href*='tab1']").trigger('click');
            });
        });
        
        /* 自己业务 */
        $('.go-query').click(function(){
        	var start = $('#date01').val();
        	var end = $('#date02').val();
        	var macs = $('.macs').val();
        	var macArray = "";
        	if(macs){
        		macArray = macs.replace(new RegExp("\n","gm"),",");
        	}
        	$.ajax({
        		   type: "GET",
        		   url: "../../end/lockEndRideReqSuccRadio",
        		   data: "startDate="+start+"&endStart="+end+"&macs="+macArray,
        		   success: function(msg){
        			   
        			   if('001' == msg.code){
        				   window.location.href="../index.html";
        			   }
        			   
        			   if(msg.status == false){
        				   alert(msg.msg);
        			   }
        			   
        			   $(' .mytable > tbody > tr').remove();
        			   $.each(msg.data, function(i, v){
    					   var tr ="<tr>";
    					   tr +="<td>"+(i+1)+"</td>";
    					   tr +="<td>"+v.mac+"</td>";
    					   tr +="<td>"+v.openLockSuccTime+"</td>";
    					   tr +="<td>"+v.openLockFailTime+"</td>";
    					   tr +="<td>"+v.requestEndRideFeeTime+"</td>";
    					   tr +="<td>"+toPercent(v.requestEndRideFeeRadio)+"</td>";
    					   tr += "</tr>"
    					   $(' .mytable > tbody').append(tr);
    				   });
        		   }
        	});
        	
        });
        
        /**
         *这里需要先用Number进行数据类型转换，然后去指定截取转换后的小数点后几位(按照四舍五入)，这里是截取一位，0.1266转换后会变成12.7%
         */
         function toPercent(point){
             var str=Number(point*100).toFixed(2);
             str+="%";
             return str;
         }
        
        function getLocalTime(nS) {
    		return new Date(parseInt(nS)).toLocaleString().replace(/:\d{1,2}$/,' ');
    	}
        
        </script>
    </body>

</html>